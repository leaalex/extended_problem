<style>

    #words_pair_wrap{
        font-size: 2em;
        background: #aeeeff;
        color: black;
        padding: 20px;
        height: 50px;
        /*width: 500px;*/
        display: flex;
        justify-content: center; /* align horizontal */
        align-items: center;
        -webkit-touch-callout: none; /* iOS Safari */
        -webkit-user-select: none; /* Safari */
        -khtml-user-select: none; /* Konqueror HTML */
        -moz-user-select: none; /* Firefox */
        -ms-user-select: none; /* Internet Explorer/Edge */
        user-select: none; /* Non-prefixed version, currently supported by Chrome and Opera */
    }

    #semantic_memory{
        max-width: 1000px;
    }

</style>
<!--<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js"></script>-->

<script type="text/javascript">

    const language = "ru";

    var translations = {
        en: {
            start_btn_label: "Start",
            reset_btn_label: "Restart",
            check_btn_label: "Check",
            series_a_label: "Series A",
            series_b_label: "Series B",

        },
        ru: {
            start_btn_label: "Начать",
            reset_btn_label: "Начать заново",
            check_btn_label: "Проверить",
            series_a_label: "Серия А",
            series_b_label: "Серия Б",

        }
    };

    const series_A_lib = [
        {
            w1: "машина",
            w2: "ехать",
            required: "w2"
        },
        {
            w1: "кружка",
            w2: "пить",
            required: "w2"
        },
        {
            w1: "ручка",
            w2: "писать",
            required: "w2"
        },
        {
            w1: "ботинки",
            w2: "шнурки",
            required: "w2"
        },
        {
            w1: "собака",
            w2: "лаять",
            required: "w2"
        },
        {
            w1: "зима",
            w2: "снеговик",
            required: "w2"
        },
        {
            w1: "свеча",
            w2: "гореть",
            required: "w2"
        },
        {
            w1: "очки",
            w2: "видеть",
            required: "w2"
        },
        {
            w1: "утюг",
            w2: "гладить",
            required: "w2"
        },
        {
            w1: "дерево",
            w2: "лист",
            required: "w2"
        },
        {
            w1: "помидор",
            w2: "овощ",
            required: "w2"
        },
        {
            w1: "рыцарь",
            w2: "защищать",
            required: "w2"
        },
        {
            w1: "армия",
            w2: "солдат",
            required: "w2"
        },
        {
            w1: "кирпич",
            w2: "строить",
            required: "w2"
        },
        {
            w1: "кастрюля",
            w2: "варить",
            required: "w2"
        },
        {
            w1: "стул",
            w2: "сидеть",
            required: "w2"
        },
        {
            w1: "лопата",
            w2: "яма",
            required: "w2"
        },
        {
            w1: "утро",
            w2: "рассвет",
            required: "w2"
        },
        {
            w1: "время",
            w2: "часы",
            required: "w2"
        },
        {
            w1: "телефон",
            w2: "звонок",
            required: "w2"
        },
        {
            w1: "газ",
            w2: "тормоз",
            required: "w2"
        },
        {
            w1: "свинья",
            w2: "поросенок",
            required: "w2"
        },
        {
            w1: "гитара",
            w2: "струна",
            required: "w2"
        },
        {
            w1: "страна",
            w2: "город",
            required: "w2"
        },
        {
            w1: "собака",
            w2: "щенок",
            required: "w2"
        },
        {
            w1: "рука",
            w2: "локоть",
            required: "w2"
        },
        {
            w1: "ключ",
            w2: "замок",
            required: "w2"
        },
        {
            w1: "соль",
            w2: "перец",
            required: "w2"
        },
        {
            w1: "галстук",
            w2: "бабочка",
            required: "w2"
        },
        {
            w1: "врач",
            w2: "халат",
            required: "w2"
        },
        {
            w1: "зачет",
            w2: "экзамен",
            required: "w2"
        },
        {
            w1: "лето",
            w2: "море",
            required: "w2"
        },
        {
            w1: "карта",
            w2: "искать",
            required: "w2"
        }];

    const series_B_lib = [
        {
            w1: "слон",
            w2: "автобус",
            required: "w2"
        },
        {
            w1: "брюки",
            w2: "небо",
            required: "w2"
        },
        {
            w1: "ключи",
            w2: "город",
            required: "w2"
        },
        {
            w1: "вилка",
            w2: "провод",
            required: "w2"
        },
        {
            w1: "сестра",
            w2: "дуб",
            required: "w2"
        },
        {
            w1: "бег",
            w2: "огурец",
            required: "w2"
        },
        {
            w1: "остров",
            w2: "пчела",
            required: "w2"
        },
        {
            w1: "гроза",
            w2: "отец",
            required: "w2"
        },
        {
            w1: "химия",
            w2: "матрас",
            required: "w2"
        },
        {
            w1: "корабль",
            w2: "свинья",
            required: "w2"
        },
        {
            w1: "железо",
            w2: "голова",
            required: "w2"
        },
        {
            w1: "часы",
            w2: "звезда",
            required: "w2"
        },
        {
            w1: "краска",
            w2: "водопад",
            required: "w2"
        },
        {
            w1: "осанка",
            w2: "корона",
            required: "w2"
        },
        {
            w1: "самолет",
            w2: "камень",
            required: "w2"
        },
        {
            w1: "десерт",
            w2: "собор",
            required: "w2"
        },
        {
            w1: "спорт",
            w2: "мороз",
            required: "w2"
        },
        {
            w1: "мамонт",
            w2: "круг",
            required: "w2"
        },
        {
            w1: "горох",
            w2: "брат",
            required: "w2"
        },
        {
            w1: "лампа",
            w2: "круг",
            required: "w2"
        },
        {
            w1: "мышь",
            w2: "кулак",
            required: "w2"
        },
        {
            w1: "щука",
            w2: "ботинок",
            required: "w2"
        },
        {
            w1: "крот",
            w2: "поезд",
            required: "w2"
        },
        {
            w1: "зеркало",
            w2: "краб",
            required: "w2"
        },
        {
            w1: "карман",
            w2: "крыша",
            required: "w2"
        },
        {
            w1: "капуста",
            w2: "пояс",
            required: "w2"
        },
        {
            w1: "шапка",
            w2: "март",
            required: "w2"
        },
        {
            w1: "враг",
            w2: "кот",
            required: "w2"
        },
        {
            w1: "алмаз",
            w2: "книга",
            required: "w2"
        },
        {
            w1: "стрела",
            w2: "люстра",
            required: "w2"
        },
        {
            w1: "жаба",
            w2: "носок",
            required: "w2"
        },
        {
            w1: "зуб",
            w2: "дом",
            required: "w2"
        },
        {
            w1: "завтрак",
            w2: "теннис",
            required: "w2"
        }];

    var word_pairs_count = 15;
    var word_display_time = 4000;
    var delay_between_words = 600;

    var series_A = series_A_lib.sort(function () {
        return .5 - Math.random()
    }).slice(0, word_pairs_count);

    var series_B = series_B_lib.sort(function () {
        return .5 - Math.random()
    }).slice(0, word_pairs_count);

    console.log("series_A: ", series_A);
    console.log("series_B: ", series_B);

    $(document).ready(function () {

//         var countdownTimer = function (elem, stop_time , options, stop_func) {
//
//             var timer = createTimer(),
//                 offset,
//                 clock,
//                 interval;
//
//             clock = stop_time * 1000;
//             options = options || {};
//             options.delay = options.delay || 1;
//
//             elem.appendChild(timer);
//
//             reset();
//
//             function createTimer() {
//                 var timer_div = document.createElement("div");
//                 timer_div.className = "timer-block";
//                 return timer_div;
//             }
//
//
//             function start() {
//                 if (!interval) {
//                     offset = Date.now();
//                     console.log(interval);
//                     interval = setInterval(update, options.delay);
//                 }
//             }
//
//             function stop() {
//                 if (interval) {
//                     clearInterval(interval);
//                     interval = null;
//                 }
//             }
//
//             function reset() {
//                 clock = stop_time * 1000;
//                 render();
//             }
//
//             function update() {
//                 // console.log(clock);
//                 if(clock > 0) {
//                     clock -= delta();
//                 }
//                 else{
//                     clock = 0;
//                     stop();
//                     stop_func();
//                 }
//                 render();
//             }
//
//             function current_time() {
//                 return clock / 1000;
//             }
//
//             function render() {
//                 timer.innerHTML = "<strong>" + sec2time(clock / 1000) + "</strong>";
//             }
//
//             function delta() {
//                 var now = Date.now(),
//                     d = now - offset;
//                 offset = now;
//                 return d;
//             }
//
//             function sec2time(timeInSeconds) {
//                 var pad = function (num, size) {
//                         return ('000' + num).slice(size * -1);
//                     },
//                     time = parseFloat(timeInSeconds).toFixed(3),
//                     hours = Math.floor(time / 60 / 60),
//                     minutes = Math.floor(time / 60) % 60,
//                     seconds = Math.floor(time - minutes * 60),
//                     milliseconds = time.slice(-3);
//
//                 return pad(minutes, 2) + ':' + pad(seconds, 2)
//                 // return pad(hours, 2) + ':' + pad(minutes, 2) + ':' + pad(seconds, 2) + ',' + pad(milliseconds, 3);
//             }
//
// // public API
//             this.current_time = current_time;
//             this.start = start;
//             this.stop = stop;
//             this.reset = reset;
//         };

        var Stopwatch = function (elem, options) {

            var timer = createTimer(),
                offset,
                clock,
                interval;

            options = options || {};
            options.delay = options.delay || 1;

            // elem.

            elem.appendChild(timer);

            reset();

            // private functions
            function createTimer() {
                var timer_div = document.createElement("div");
                timer_div.className = "timer-block";
                return timer_div;
            }


            function start() {
                if (!interval) {
                    offset = Date.now();
                    interval = setInterval(update, options.delay);
                }
            }

            function stop() {
                if (interval) {
                    clearInterval(interval);
                    interval = null;
                }
            }

            function reset() {
                clock = 0;
                render();
            }

            function update() {
                clock += delta();
                render();
            }

            function current_time() {
                return clock / 1000;
            }

            function render() {
                timer.innerHTML = "" + sec2time(clock / 1000) + "";
            }

            function delta() {
                var now = Date.now(),
                    d = now - offset;

                offset = now;
                return d;
            }

            function sec2time(timeInSeconds) {
                var pad = function (num, size) {
                        return ('000' + num).slice(size * -1);
                    },
                    time = parseFloat(timeInSeconds).toFixed(3),
                    hours = Math.floor(time / 60 / 60),
                    minutes = Math.floor(time / 60) % 60,
                    seconds = Math.floor(time - minutes * 60),
                    milliseconds = time.slice(-3);

                // return pad(minutes, 2) + ':' + pad(seconds, 2);
                return pad(hours, 2) + ':' + pad(minutes, 2) + ':' + pad(seconds, 2) + ',' + pad(milliseconds, 3);
            }

            // public API
            this.current_time = current_time;
            this.start = start;
            this.stop = stop;
            this.reset = reset;
        };

        function showSeries(array, index, target, word_delay, word_pause) {

            $("#test_div").append("<p> Задержка перед парой № "  + (index+1).toString() + ": "+ countdown_timer.current_time() + " сек. </p>");
            countdown_timer.stop();
            countdown_timer.reset();

            // var slideTime = Math.round(word_pause/3);
            var slideTime = Math.round(word_pause/3);
            let current_string = array[index].w1 + " - " + array[index].w2;
            if (array.length - index === 1) {
                $(target).html(current_string);
                $(target).slideDown(slideTime);
                countdown_timer.start();
                setTimeout(function () {
                    $(target).slideUp(slideTime);
                    $("#test_div").append("<p>Показывали пару № " + (index+1).toString() + ": " + countdown_timer.current_time() + " сек. </p>");
                    $("#test_div").append("<p>Закончили</p>");
                    countdown_timer.stop();
                    countdown_timer.reset();
                }, word_delay);
            }
            else {
                $(target).html(current_string);
                $(target).slideDown(slideTime);
                countdown_timer.start();
                setTimeout(function () {
                        $(target).slideUp(slideTime);
                        $("#test_div").append("<p>Показывали пару № " + (index+1).toString() + ": " + countdown_timer.current_time() + " сек. </p>");
                        countdown_timer.stop();
                        countdown_timer.reset();
                        setTimeout(function () { showSeries(array, ++index, target, word_delay, word_pause); }, word_pause);
                        countdown_timer.start();
                    },
                    word_delay
                )
            }
        }

        var countdown_timer = new Stopwatch($("#countdown_timer")[0] );

        $("#start_series_A").click(function () {
            // $("#series_title").html("Серия А");
            $("#test_div").html("");
            // countdown_timer.stop();
            // countdown_timer.reset();
            countdown_timer.start();
            showSeries(series_A, 0, $("#words_pair"), word_display_time, delay_between_words);
        });

        // $("#start_series_B").click(function () {
        //     $("#series_title").html("Серия Б");
        //     showSeries(series_B, 0, $("#words_pair"), word_display_time, delay_between_words);
        // });
        //
        // $("#start_series_B").hide();

    });

</script>

<div id="semantic_memory">

    <button id="start_series_A">Начать первую серию</button>
    <!--<button id="start_series_B">Начать вторую серию</button>-->

    <!--<div id="series_title"></div>-->
    <div id="countdown_timer"></div>
    <div id="words_pair_wrap">
        <div id="words_pair" style="display: none;"></div>
    </div>

    <div id="test_div"></div>
</div>

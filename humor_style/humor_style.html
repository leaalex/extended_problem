<style>

.question-wrap{
    /*margin: 10px 0px;*/
    padding: 10px;
    border-bottom: 1px solid #c9c9c9;
}

.question-wrap-text{
    margin: 5px 0px;
}

.question-wrap-radio{
    padding: 5px 10px;
}

.radio-input{
    margin-top: -1px;
    vertical-align: middle;
    margin-right: 5px;
}

.radio-label{
    width: fit-content;
    display: block;
}


.check-button-wrap {
    padding: 1.5em 0;
    text-align: center;
}


.check-button {
    font-family: "Open Sans", Verdana, Geneva, sans-serif, sans-serif;
    /*width: 6em;*/
    text-shadow: none !important;
    background: #046b99;
    color: #ffffff;
    font-size: 1.5em;
    font-weight: normal;
    border: none;
}

.check-button:hover {
    /*font-family: "Open Sans",Verdana,Geneva,sans-serif,sans-serif;
    width: 200px;*/
    /* height: 50px; */
    background: #035c83 !important;
    border: none;
    cursor: pointer;
}

.check-button:focus {
    border: none !important;
    box-shadow: none !important;
}

</style>

<!--<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js"></script>-->

<script type="text/javascript">
    $(document).ready(function () {

        const language = 'ru'; // ru or en
        const translations = {
            en: {
                start_btn_label: "Начать",
                reset_btn_label: "Начать заново",
                check_btn_label: "Проверить",
                result_label: "Результаты:",
                start_instruction: "тут наверно надо что-то написать?",
                result_instruction: "Здесь описаны присущие Вам тип(ы) юмора",

                affiliated_label: "Аффилиативный юмор",
                self_sustaining_label: "Самоподдерживающий",
                aggressive_label: "Агрессивный юмор",
                self_deprecating_label: "Самоуничижительный стиль",

                affiliated_description: "(поддерживающий, направленный на других) связывается с экстраверсией, открытостью новому опыту, оптимизмом, жизнерадостностью, самопринятием и самоценностью, с успешностью установления и поддержания межличностных отношений, удовлетворенностью качеством жизни, преобладанием положительных эмоций и хорошего настроения. Люди c аффилиативным чувством юмора часто шутят, спонтанно вовлекаются в добродушный обмен шутливыми замечаниями. Этот мягкий, доброжелательный и толерантный стиль юмора способствует укреплению межличностных отношений и росту взаимной привлекательности.",
                self_sustaining_description: "(поддерживающий, направленный на себя) стиль юмора подразумевает оптимистичный взгляд на жизнь, умение сохранять чувство юмора перед лицом трудностей и проблем, то есть является регулятором эмоций и механизмом совладания со стрессом. По сравнению с аффилиативным, самоподдерживающий юмор выполняет, в первую очередь, интрапсихическую функцию и потому не так сильно связан с экстраверсией. Он имеет отрицательную связь с нейротизмом и положительно коррелирует с оптимизмом, открытостью новому опыту, самоценностью и удовлетворенностью качеством жизни, с успешностью установления и поддержания межличностных отношений.",
                aggressive_description: "(деструктивный, направленный на других) включает в себя сарказм, насмешку, подтрунивание, он может быть использован в целях манипуляции другим. Люди с агрессивным стилем юмора часто не могут справиться с желанием сострить, даже если шутка может кого-то обидеть. Этот стиль юмора положительно связан с нейротизмом, враждебностью, гневом и агрессией и отрицательно – с удовлетворенностью межличностными отношениями, дружелюбием и совестливостью, социальной компетентностью, способностью оказывать эмоциональную поддержку другому человеку и эффективностью юмора как копинг-стратегии.",
                self_deprecating_description: "(деструктивный, направленный на себя) означает использование юмора, направленного против самого себя, с целью снискания расположения значимых других. Такие люди, заискивая перед окружающими, позволяют им делать себя объектом шуток и готовы разделить с ними этот смех. Хотя они могут восприниматься как остроумные и веселые, за этим стоят низкая самооценка и обостренная потребность в принятии. Они испытывают трудности в отстаивании своих прав. Самоуничижительный стиль юмора положительно связывается с нейротизмом, депрессией, тревогой и отрицательно – с удовлетворенностью межличностными отношениями, качеством жизни, психологическим благополучием, самоценностью.",
            },
            ru: {
                start_btn_label: "Начать",
                reset_btn_label: "Начать заново",
                check_btn_label: "Проверить",
                result_label: "Результаты:",
                start_instruction: "тут наверно надо что-то написать? теоретически студент может набирать везде по нулям (даже ответив на все вопросы)",
                result_instruction: "Здесь описаны присущие Вам тип(ы) юмора",

                affiliated_label: "Аффилиативный юмор",
                self_sustaining_label: "Самоподдерживающий",
                aggressive_label: "Агрессивный юмор",
                self_deprecating_label: "Самоуничижительный стиль",

                affiliated_description: "(поддерживающий, направленный на других) связывается с экстраверсией, открытостью новому опыту, оптимизмом, жизнерадостностью, самопринятием и самоценностью, с успешностью установления и поддержания межличностных отношений, удовлетворенностью качеством жизни, преобладанием положительных эмоций и хорошего настроения. Люди c аффилиативным чувством юмора часто шутят, спонтанно вовлекаются в добродушный обмен шутливыми замечаниями. Этот мягкий, доброжелательный и толерантный стиль юмора способствует укреплению межличностных отношений и росту взаимной привлекательности.",
                self_sustaining_description: "(поддерживающий, направленный на себя) стиль юмора подразумевает оптимистичный взгляд на жизнь, умение сохранять чувство юмора перед лицом трудностей и проблем, то есть является регулятором эмоций и механизмом совладания со стрессом. По сравнению с аффилиативным, самоподдерживающий юмор выполняет, в первую очередь, интрапсихическую функцию и потому не так сильно связан с экстраверсией. Он имеет отрицательную связь с нейротизмом и положительно коррелирует с оптимизмом, открытостью новому опыту, самоценностью и удовлетворенностью качеством жизни, с успешностью установления и поддержания межличностных отношений.",
                aggressive_description: "(деструктивный, направленный на других) включает в себя сарказм, насмешку, подтрунивание, он может быть использован в целях манипуляции другим. Люди с агрессивным стилем юмора часто не могут справиться с желанием сострить, даже если шутка может кого-то обидеть. Этот стиль юмора положительно связан с нейротизмом, враждебностью, гневом и агрессией и отрицательно – с удовлетворенностью межличностными отношениями, дружелюбием и совестливостью, социальной компетентностью, способностью оказывать эмоциональную поддержку другому человеку и эффективностью юмора как копинг-стратегии.",
                self_deprecating_description: "(деструктивный, направленный на себя) означает использование юмора, направленного против самого себя, с целью снискания расположения значимых других. Такие люди, заискивая перед окружающими, позволяют им делать себя объектом шуток и готовы разделить с ними этот смех. Хотя они могут восприниматься как остроумные и веселые, за этим стоят низкая самооценка и обостренная потребность в принятии. Они испытывают трудности в отстаивании своих прав. Самоуничижительный стиль юмора положительно связывается с нейротизмом, депрессией, тревогой и отрицательно – с удовлетворенностью межличностными отношениями, качеством жизни, психологическим благополучием, самоценностью.",
            }
        };

        const user_labels = translations[language];

    var HumorStyle = function (html_element) {
        $(html_element).html("");
        var questions_object = {
            question_1: {
                text: "Я не склонен постоянно шутить и смеяться с другими людьми."
            },
            question_2: {
                text: "Обычно, когда я один и чувствую себя подавленным, юмор поднимает мне настроение."
            },
            question_3: {
                text: "Если кто-то допускает ошибку, я часто подшучиваю над этим."
            },
            question_4: {
                text: "Я позволяю людям смеяться, подшучивать над собой больше, чем следовало бы."
            },
            question_5: {
                text: "Мне нетрудно рассмешить других — мне кажется, у меня от природы хорошее чувство юмора."
            },
            question_6: {
                text: "Когда я подавлен, меня не смешат нелепости жизни."
            },
            question_7: {
                text: "Мой юмор никогда не обижает и не задевает других людей."
            },
            question_8: {
                text: "Я могу увлечься самокритикой или принижением самого себя, если это смешит мою семью или друзей."
            },
            question_9: {
                text: "Мне редко удается рассмешить людей, когда я рассказываю смешные истории."
            },
            question_10: {
                text: "Если я расстроен или чувствую себя несчастным, я стараюсь найти нечто смешное в ситуации, чтобы почувствовать себя лучше."
            },
            question_11: {
                text: "Когда я шучу или рассказываю нечто смешное, меня мало волнует, обидит ли это кого-то."
            },
            question_12: {
                text: "Я часто стараюсь расположить к себе людей, понравиться им, рассказывая что-нибудь смешное о своих слабостях, промахах или неудачах."
            },
            question_13: {
                text: "Близкие друзья считают, что я много шучу и смеюсь."
            },
            question_14: {
                text: "Если я расстроен чем-то, мое чувство юмора помогает мне не впадать в отчаяние."
            },
            question_15: {
                text: "Мне не нравится, когда кто-то использует юмор с целью критики или унижения других."
            },
            question_16: {
                text: "Я не склонен шутить над собой, делая себя объектом юмора."
            },
            question_17: {
                text: "Обычно мне не нравится рассказывать анекдоты и развлекать людей."
            },
            question_18: {
                text: "Если я один и чувствую себя несчастным, я стараюсь подумать о чем-нибудь смешном, чтобы поднять себе настроение."
            },
            question_19: {
                text: "Если мне приходит в голову нечто остроумное, я не могу сдержаться и не рассказать, даже если это кого-то обидит."
            },
            question_20: {
                text: "Я часто перегибаю палку, иронизируя над собой, чтобы рассмешить окружающих."
            },
            question_21: {
                text: "Мне доставляет удовольствие веселить других.>"
            },
            question_22: {
                text: "Мне трудно сохранять чувство юмора, если я расстроен или мне грустно."
            },
            question_23: {
                text: "Я никогда не смеюсь над другими, даже если все мои друзья делают это."
            },
            question_24: {
                text: "В компании друзей или в кругу семьи надо мной часто подшучивают."
            },
            question_25: {
                text: "В компании друзей я шучу реже, чем другие.>"
            },
            question_26: {
                text: "Даже если найти нечто смешное в ситуации, от трудностей это не избавит."
            },
            question_27: {
                text: "Если мне кто-то не нравится, я часто шучу или подтруниваю над этим человеком."
            },
            question_28: {
                text: "Я использую свои жизненные проблемы и слабости для того, чтобы повеселить других."
            },
            question_29: {
                text: "Обычно в присутствии других людей я могу придумать гораздо более остроумные вещи, чем другие."
            },
            question_30: {
                text: "Мне не всегда нужна компания для того, чтобы развеселиться – я найду над чем посмеяться, даже будучи в одиночестве."
            },
            question_31: {
                text: "Даже если что-то кажется мне очень смешным, я не буду смеяться или шутить по этому поводу, если это кого-то обидит."
            },
            question_32: {
                text: "Позволять другим смеяться надо мной – мой способ поддерживать друзей и семью в хорошем расположении духа."
            }
        };

        var answer_choices = {
            a: "Полностью не согласен",
            b: "Не согласен",
            c: "Скорее не согласен",
            d: "Не могу определиться",
            e: "Скорее согласен",
            f: "Согласен",
            g: "Полностью согласен"
        };
        var user_answers = {};
        let statements = {
            direct: ["e", "f", "g"],
            inverse: ["a", "b", "c"]
        };
        let humors = {
            affiliated: {
                direct: [1, 5, 9, 13, 21, 25, 29],
                inverse: [17]
            },
            self_sustaining:{
                direct: [2, 10, 14, 18, 30],
                inverse: [6, 22, 26]
            },
            aggressive: {
                direct: [3, 11, 19, 27],
                inverse: [7, 15, 23, 31]
            },
            self_deprecating:{
                direct: [4, 8, 12, 20, 24, 28, 32],
                inverse: [16]
            }
        };

        create_questions_block();

        function set_result(){
            let humors_result = {
                affiliated: 0,
                self_sustaining:0,
                aggressive: 0,
                self_deprecating:0
            };

            Object.keys(user_answers).forEach(function(item, idx){
                let num_question = parseInt(item.replace('question_',''));

                if(statements.direct.includes(user_answers[item])){
                    if (humors.affiliated.direct.includes(num_question)){
                        humors_result.affiliated += 1;
                    }
                    else if (humors.self_sustaining.direct.includes(num_question)){
                        humors_result.self_sustaining += 1;
                    }
                    else if (humors.aggressive.direct.includes(num_question)){
                        humors_result.aggressive += 1;
                    }
                    else if (humors.self_deprecating.direct.includes(num_question)){
                        humors_result.self_deprecating += 1;
                    }
                    else {
                        // console.error("Неизвестный вопрос", num_question);
                    }
                }
                else if (statements.inverse.includes(user_answers[item])) {
                    if (humors.affiliated.inverse.includes(num_question)){
                        humors_result.affiliated += 1;
                    }
                    else if (humors.self_sustaining.inverse.includes(num_question)){
                        humors_result.self_sustaining += 1;
                    }
                    else if (humors.aggressive.inverse.includes(num_question)){
                        humors_result.aggressive += 1;
                    }
                    else if (humors.self_deprecating.inverse.includes(num_question)){
                        humors_result.self_deprecating += 1;
                    }
                    else {
                        // console.error("Неизвестный вопрос", num_question);
                    }
                }
                else{
                     // выбран вариант 'Не могу определиться'
                     // console.log('Не могу определиться')
                }


            });

            var humors_result_array = Object.keys(humors_result).map(item=>{return {'name': item, 'value': humors_result[item]}});
            humors_result_array = humors_result_array.filter(item=>item.value==humors_result_array.reduce(function (prev, current) {return (prev.value > current.value) ? prev : current}).value);
            return humors_result_array;
        }

        function createResultBlock() {

            var result_block = $("<div>", {
               html: "<h2>" + user_labels.result_label + "</h2>",
               class: ""
            });

            $(result_block).append("<p>" + user_labels.result_instruction + "</p>");

            set_result().forEach(function (item) {
                $(result_block).append("<p><strong>" + user_labels[item.name+"_label"] + "</strong> "  + user_labels[item.name+"_description"] +  "<p>");
            });

            $(html_element).html(result_block);

            // console.log(set_result());

            $("<button>", {
                html: user_labels.reset_btn_label,
                click: function () {
                    humor_style = new HumorStyle(humor_style_block);
                }
            }).appendTo(html_element);

            $('body').scrollTo(html_element, 300, {offset: -100});

        }

        function create_questions_block() {
            $(html_element).append("<p>" + user_labels.start_instruction + "</p>");
            Object.keys(questions_object).forEach(function (item, idx) {

                user_answers[item] = 'd';
                let question_wrap = $("<div>", {
                    class: "question-wrap",
                    html: `<div class="question-wrap-text"><b>${idx + 1}.</b> ${questions_object[item].text}</div>`
                });

                let radio_wrap = $("<div>", {
                    class: "question-wrap-radio"
                });

                Object.keys(answer_choices).forEach(function (answer) {
                    let radio_label = $("<label>", {
                        html: answer_choices[answer],
                        class: "radio-label",
                    });
                    let radio_input = $("<input>", {
                        type: "radio",
                        class: "radio-input",
                        value: answer,
                        name: item
                    });

                    if (user_answers[item] == answer){
                        radio_input.prop('checked', true);
                    }

                    radio_label.prepend(radio_input);
                    $(radio_wrap).append(radio_label);

                });
                question_wrap.append(radio_wrap);
                $(html_element).append(question_wrap);

                // let value = ["a", "b", "c", "d", "e", "f", "g"][Math.floor(Math.random() * ["a", "b", "c", "d", "e", "f", "g"].length)];
                // $("input[name=" + item + "][value='" + value + "']").prop('checked', true);
                // user_answers[item] = value;
            });

            $(".radio-input").change(function () {
                user_answers[this.name] = this.value;
                // set_result()
            });

            var check_button_wrap = $("<div>", {
                class: "check-button-wrap"
            });

            var check_button = $("<button>", {
                html: user_labels.check_btn_label,
                class: "check-button"
            }).appendTo(check_button_wrap);

            check_button.click(function () {
                createResultBlock();
            });

            $(html_element).append(check_button_wrap);

        }
    };


    var humor_style_block = document.getElementById("humor_style_block");

    var humor_style = new HumorStyle(humor_style_block);

    console.log(humor_style)


    });

</script>

<div id="humor_style_block">

</div>

<problem>
<script type="loncapa/python">
more_sign = ">"
def check_answer(expect, ans):
    return 1
</script>

    <style type="text/css">

        .answer-table td {
            border: 1px solid;
            margin: 20px 0;
            padding: 10px;
            border: 1px solid #c8c8c8;
            font-size: 14px;
        }

        .answer-table th {
            background: white;
        }

        .radio-td {
            text-align: center;
            position: relative;
        }

        .radio-td:hover {
            background: #ebf0ff;
        }

        .title-td {
            padding: 6px !important;

        }

        .radio-label {
            margin-bottom: 0px;
            margin-top: 0px;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .radio-label input {
            width: 15px !important;
            height: 15px !important;
        }

        .radio-input:hover {
            cursor: pointer;
        }

        .heading-td {

            width: 80px !important;
            text-align: center !important;

            margin: 20px 0 !important;
            padding: 10px !important;
            border: 1px solid #c8c8c8;
            /*font-size: 14px;*/
            background: #eee !important;
        }

        .answer-table td, .answer-table th {
            word-break: initial !important;

        }

        .table-block tr:hover {
            background: #d5f0fd;
        }

        td.empty-td {
            min-width: 30px;
        }

        span.submit-label {
            text-transform: initial !important;
        }


    </style>

    <script type="text/javascript">
        $(document).ready(function () {

            $.fn.enableButton = function() {
                this.removeClass("disabled");
                this.removeAttr("disabled");
            };
            $.fn.disableButton = function() {
                this.addClass("disabled");
                this.removeAttr("disabled");
            };


            const translations = {
                en: {
                    start_btn_label: "Начать",
                    reset_btn_label: "Начать заново",
                    change_answers_btn_label: "Изменить ответы",
                    instruction_label: "Инструкция",
                    instruction_text: "<p>Представьте себе, что вы – экзаменатор, оценивающий предлагаемые ниже суждения так, что:</p><ul><li>неудовлетворяющие из них лично вас оцениваются <em>единицей</em> или <em>двойкой</em>;</li><li>совпадающие с вашим личным мнением или близкие к нему – <em>четверкой</em> или <em>пятеркой</em>;</li><li>оценка «3» не должна использоваться вовсе.</li></ul><p>Оценивается каждое суждение без особенно долгих раздумий, чтобы не затягивать процедуру экзамена.</p><p>За советами, будучи в положении экзаменатора, вам обращаться не рекомендуется – оценки ставятся по первому ясному впечатлению напротив номеров суждений</p>",
                    result_label: "Результаты",
                    result_text: "Ваша мотивационная стратегия",
                    some_result_alert_text: "Рекомендуем вам вновь обратиться к вопросам соответствующих столбцов, по которым вы, как экзаменатор, проявили избыточную доброжелательность и тем самым невольно уравняли различное. Исправить достаточно две-три оценки.",
                    points_label: "балла",
                    points_1_label: "баллов",
                    point_label: "балл",
                },
                ru: {
                    start_btn_label: "Начать",
                    reset_btn_label: "Начать заново",
                    change_answers_btn_label: "Изменить ответы",
                    instruction_label: "Инструкция",
                    instruction_text: "<p>Представьте себе, что вы – экзаменатор, оценивающий предлагаемые ниже суждения так, что:</p><ul><li>неудовлетворяющие из них лично вас оцениваются <em>единицей</em> или <em>двойкой</em>;</li><li>совпадающие с вашим личным мнением или близкие к нему – <em>четверкой</em> или <em>пятеркой</em>;</li><li>оценка «3» не должна использоваться вовсе.</li></ul><p>Оценивается каждое суждение без особенно долгих раздумий, чтобы не затягивать процедуру экзамена.</p><p>За советами, будучи в положении экзаменатора, вам обращаться не рекомендуется – оценки ставятся по первому ясному впечатлению напротив номеров суждений</p>",
                    result_label: "Результаты",
                    result_text: "Ваша мотивационная стратегия",
                    some_result_alert_text: "Рекомендуем вам вновь обратиться к вопросам соответствующих столбцов, по которым вы, как экзаменатор, проявили избыточную доброжелательность и тем самым невольно уравняли различное. Исправить достаточно две-три оценки.",
                    points_label: "балла",
                    points_1_label: "баллов",
                    point_label: "балл",
                }
            };

            function reset_answer(){
                state.completed = false;
                answer.setJSON({answer: state});
            }

            const types_description = {
                L: {
                    title: "«Лев»",
                    description: [
                        "Основной способ (мотив) взаимодействия – «да-да», то есть мотив взаимного принятия внутреннего и внешнего, их взаимного положительного отрицания, обусловливающего возможность саморазвития личности. Конструктивное единство мотивации достижения и мотивации отношения, результатом которого является стремление к сотрудничеству. Уравновешенность внутреннего и внешнего во взаимодействии является основой баланса целей и отношений как во внешнем, так и во внутреннем планах личности. В идеале «Лев» на основе интернальности и экстравертности устремлен к совместному творчеству во всех основных видах деятельности и в преодолении разногласий (по К.Томасу – стремление к сотрудничеству).",
                        "Может быть Учителем (с большой буквы), (ди)ректором, основателем (научной) школы, собирателем, пастырем, духовным наставником, мастером на все руки. Пассионарность его имеет чрезвычайное общественное значение. Но при нетребовательном к себе отношении и общественной невостребованности «вырождается» в безобидного весельчака, мечтателя, болельщика в общественных явлениях, завсегдатая компаний, «своего парня».",
                        "В случаях крайнего напряжения душевных и физических сил обнаруживается по параметру личностной реактивности в темпераменте холерика, в то время как обычное личностное состояние по параметру его конструктивной активности – сангвиния. Это следует понимать так, что «львом» не рождаются, им становятся. Причем, скорее всего это происходит либо в сфере общения, либо в познавательной деятельности, где для этого имеются специфические, собственно человеческие, родовые для человека разумного «тепличные» условия.",
                        "Особенно часто тип «льва» диагностируется в научной среде, в выборках школьников и студентов, в благополучных семьях и производственных объединениях. В то же время вне оптимальных условий деятельности или вне специального воспитания «лев» при той же самой мотивационной стратегии проявляет себя, согласно нашей модели типологического единства личности, именно своим естественно-реактивным образом, как холерик, со всеми вытекающими из этого следствиями. В различной мере эффект самовоспитания демонстрируют такие, например, «львы», как Сергий Радонежский, Д.И.Менделеев, В.И.Вернадский, И.П.Павлов."
                    ]
                },
                P: {
                    title: "«Пантера»",
                    description: [
                        "Основной способ (мотив) взаимодействия – «да – нет», то есть мотив реконструктивного единства мотивации достижения и мотивации отношения, когда самоактуализация личности осуществляется в общении скорее от ума, нежели от сердца.",
                        "Результатом этой реконструктивной мотивации чаще всего является «избегание» сложных ситуаций, где вновь возникают острые вопросы взаимодействия внутреннего и внешнего. Духовная работа над собою, обостренная рефлексия в самосовершенствовании в целом представляют «пантеру» как интернала, но обращенного более вовнутрь,- то есть интроверта. Мотивация отношения к самому себе доминирует над мотивацией достижения; самоотношения доминируют над целями – более важным становится постижение себя или какой-либо абстрактной истины и только затем уже, через себя, принимается внешний мир. Отсюда общая направленность на виды деятельности, предполагающие уединенность труда: ученый, писатель, композитор, мудрец, отшельник.",
                        "Обычное личностное состояние по параметру активности – меланхолия, причем именно воспитанная, приобретенная, и не обязательно в благоприятных обстоятельствах жизни.",
                        "Отсюда понятно, что в случаях стрессовых ситуаций, а еще вероятнее – в благоприятных обстоятельствах, проявляется не меланхолия, а естественно-реактивное состояние человека, в данном варианте мотивации по нашей модели личности – состояние, выраженное темпераментом сангвиника.",
                        "В положительном смысле проявления реактивности «пантера» приобретает необходимое ей чувство творческой независимости и возможность сотрудничества, а при отрицательном смысле самоосвобождения резко падает самодисциплина и человек стремительно «снижается», избавившись от присущего интерналам чувства ответственности за себя и других.",
                        "Примеры воспитанной меланхолии являли собою А.П.Чехов, Н.В.Гоголь, А.А.Ухтомский, Г.В.Ф.Гегель и Л.С.Выготский."
                    ]
                },
                T: {
                    title: "«Тигр»",
                    description: [
                        "Основной способ (мотив) взаимодействия, противоположный мотиву «пантеры» – «нет-да», означающий отрицание внутреннего по отношению к внешнему. Это проявление мотивации относится не только к себе, но и к другим: все должны следовать какой-либо внешне определенной идее, правилу-норме, цели и т.д. – как инструкции.",
                        "Деструктивное единство мотивации отношения и мотивации достижения обнаруживается в стремлении к «соперничеству», на основе которого осуществляется самовоспитание и самоутверждение личности во внешнем.",
                        "Цели и отношения личности при этом находятся в дисбалансе: доминируют цели, достижение которых, по экстернальным представлениям «тигра», мало зависит от рационального и, в частности, психологического стечения обстоятельств. Психологическое при этом понимается как инструментальное, а не как духовное достоинство человека.",
                        "Показательно, что Наполеон, являющий собою «тигра», именно инструментально определяет талант полководца как квадрат, одна сторона которого – ум, а другая – мужество. В противоположность духовной пассионарности «льва» выступает, таким образом, пассионарность конкретно материализуемая. Этот пример показывает, что в экстернально-экстравертной (объектной) стратегии поведения «тигров» доминирует экстернальность, облегчающая переход от личностного, воспитанного состояния холерии к естественно-реактивному состоянию флегматика, когда возникает реальная ситуация опасности, или, наоборот, ситуация наибольшего благоприятствования, славы и почета: тогда нет вокруг более спокойного, флегматичного человека, чем только что организовавший конфликт безудержный «тигр». Его мужество при этом как раз и есть свойственная его темпераменту выдержка, инертность активности на индивидно-индивидуальном уровне личности.",
                        "Неукротимость, бьющая через край энергия личностной холерии «тигров» позволяет им достигнуть в своей самоотверженности очень многого в общественном служении, в том числе и на поприще искусств. «Тигры» часто являются, благодаря своему основному мотиву, полководцами, горящими на работе или на алтаре семьи «воинами», «поэтами». В отрицательном плане они являют собою типы вроде Хлестакова или Ноздрева. Им необходимо в принципе более дорожить своим здоровьем, поскольку по своему темпераменту флегматика они реактивны, то есть достаточно чувствительны и потому действительно «сгорают» в переживаниях от собственного пламени холерии.",
                        "«Воспитанными» в той или иной мере «тиграми» можно назвать Наполеона, А.С.Пушкина, А.С.Суворова, Э.В.Ильенкова."
                    ]
                },
                M: {
                    title: "«Медведь»",
                    description: [
                        "Основной способ взаимодействия и его мотив – «нет-нет», то есть мотив взаимного отрицания внутреннего и внешнего, отрицательного отрицания, обусловливающего известную стабильность и равновесность обстоятельного, неспешного развития личности.",
                        "В принципе инструктивное, это единство мотивации отношения и мотивации достижения в реальности выражается в двух взаимодополняющих формах «приспособления». Первая из них – это форма подавления, властвования над другими и над собою во взаимном отрицании внутреннего мира – как своего, так и мира других людей. Вторая форма – приспособление к нравам других людей и к собственным привычкам, обеспечивающее известную стабильность существования.",
                        "Вопросы взаимодействия внутреннего и внешнего решаются преимущественно волевым, произвольным образом,- иногда в буквальном смысле последнего – совершенно непредсказуемо.",
                        "«Медведь» одновременно и экстернал и интроверт, и его поведение может варьировать от «спячки» и покорности, уповающей на счастливый случай, шанс или судьбу, до жестокого подавления своей природы и природы других людей, отношений и вещей. Поэтому «медведь» либо проявляет себя как гедонистически настроенный благодушный художник, музыкант, ученый или писатель, весьма умелый мастер, либо как властелин, царь, законодатель, судья, менеджер, чиновник, практик в лучшем смысле слова, реально и несколько пессимистически представляющий жизнь. Его флегматия, однако, является личностным состоянием, плодом отношения к нему в семье или в ближайшем окружении.",
                        "В стрессовых ситуациях обнаруживаются проявления значительно большей реактивности, так как по параметру реактивности личности «медведь» – меланхолик. Вследствие этого в решительные моменты жизни «медведь» поступает совершенно экстернально: полагается на других людей, на свой гороскоп, не отстаивает ни целей, ни отношений, уходит в отпуск, в болезнь, под «панцирь». Его спасает обычно достаточно хорошая репутация надежного, постоянного человека, так что этот «панцирь» можно понимать и как авторитет, как обладание властью или мастерством.",
                    ]
                }
            };

            function createElement(name, id, classList, attributes) {
                let element = document.createElement(name);
                if (id) element.id = id;
                if (classList) element.classList = classList;
                if (attributes) {
                    for (let attr in attributes) {
                        element.setAttribute(attr, attributes[attr])
                    }
                }
                return element;
            }

            function clearProblemSigns(element) {
                let problemXBlock = $(element).closest(".xblock");
                $(".problem-progress", problemXBlock).hide();
                $(".button.submit", problemXBlock).hide();
                $(".notification", problemXBlock).hide();
                $(".problem-action-buttons-wrapper", problemXBlock).hide();
            }

            function Answer(elementField) {
                this.elementField = elementField;
                this.fieldValue = "";
                this.fieldObject = {};
                this.get = function () {
                    this.fieldValue = elementField.value;
                    return this.fieldValue;
                };
                this.set = function (value) {
                    if (value == undefined) value = this.fieldValue;
                    elementField.value = value;
                };
                this.getJSON = function () {
                    if (this.isJsonString(this.get())) this.fieldObject = JSON.parse(this.get());
                    return this.fieldObject;
                };
                this.setJSON = function (object) {
                    if (object == undefined) object = this.fieldObject;
                    this.set(JSON.stringify(object))
                };
                this.isJsonString = function (str) {
                    try {
                        JSON.parse(str);
                    } catch (e) {
                        return false;
                    }
                    return true;
                };
            };

            function ConstructiveMotivation (html_element) {

                this.block = createElement("div", null, "table-block", {});

                this.questions = {
                    question_1: {
                        text: "Первый блин всегда комом"
                    },
                    question_2: {
                        text: "Чья земля - того и хлеб"
                    },
                    question_3: {
                        text: "Когда мягко стелят - жестко спать"
                    },
                    question_4: {
                        text: "Ум хорошо, а два лучше"
                    },
                    question_5: {
                        text: "Руби дерево по себе"
                    },
                    question_6: {
                        text: "Худую траву из поля вон"
                    },
                    question_7: {
                        text: "Не подмажешь - не поедешь"
                    },
                    question_8: {
                        text: "На вкус, да на цвет - товарища нет"
                    },
                    question_9: {
                        text: "Чужая душа потемки"
                    },
                    question_10: {
                        text: "Загнанных лошадей следует пристреливать"
                    },
                    question_11: {
                        text: "Лучше поздно, чем никогда"
                    },
                    question_12: {
                        text: "Ни у кого нет полного ответа, но у каждого есть, что добавить"
                    },
                    question_13: {
                        text: "На языке мед, а на сердце лед"
                    },
                    question_14: {
                        text: "Кто смел, тот и съел"
                    },
                    question_15: {
                        text: "Цыплят по осени считают"
                    },
                    question_16: {
                        text: "Правда в огне не горит и в воде не тонет"
                    },
                    question_17: {
                        text: "Выше головы не прыгнешь, выше лба уши не растут"
                    },
                    question_18: {
                        text: "Волка бояться - в лес не ходить"
                    },
                    question_19: {
                        text: "Лучший способ разрешать споры - вовсе избегать их"
                    },
                    question_20: {
                        text: "Выноси заботы на свет, да держи с друзьями совет"
                    },
                    question_21: {
                        text: "Ласковое телятко двух маток сосет, а упрямое - ни одной"
                    },
                    question_22: {
                        text: "Всяк сверчок знай свой шесток: в чужие сани не садись"
                    },
                    question_23: {
                        text: "На свете нет ничего, что заслуживало бы спора"
                    },
                    question_24: {
                        text: "Дружно - не грузно: согласного стада и волк не берет"
                    },
                    question_25: {
                        text: "И мутную воду пьют в невзгоду"
                    },
                    question_26: {
                        text: "Не зря, что Фоме огороды копать, а Ереме над ним воеводой стоять"
                    },
                    question_27: {
                        text: "Дружба дружбой, а служба - службой"
                    },
                    question_28: {
                        text: "В конечном счете справедливость торжествует, а зло наказывается"
                    }
                };

                this.answer_choices = {
                    a: {
                        text: "1 " + user_labels.point_label,
                        value: 1
                    },
                    b: {
                        text: "2 " + user_labels.points_label,
                        value: 2
                    },
                    c: {
                        text: "4 " + user_labels.points_label,
                        value: 4
                    },
                    d: {
                        text: "5 " + user_labels.points_1_label,
                        value: 5
                    }
                };

                this.calculateResults = function () {
                    let results = {
                        points:
                            {
                                M: 0,
                                T: 0,
                                P: 0,
                                L: 0,
                            },
                        user_types: []
                    };

                    let for_M = [1, 5, 9, 13, 17, 21, 25];
                    let for_T = [2, 6, 10, 14, 18, 22, 26];
                    let for_P = [3, 7, 11, 15, 19, 23, 27];
                    let for_L = [4, 8, 12, 16, 20, 24, 28];
                    for (let user_answer in state.result.user_answers){
                        let num_question = parseInt(user_answer.replace("question_", ""));

                        if (Object.keys(this.answer_choices).includes(state.result.user_answers[user_answer])) {
                            if (for_M.includes(num_question)) {
                                results.points.M += this.answer_choices[state.result.user_answers[user_answer]].value;
                            } else if (for_T.includes(num_question)) {
                                results.points.T += this.answer_choices[state.result.user_answers[user_answer]].value;
                            } else if (for_P.includes(num_question)) {
                                results.points.P += this.answer_choices[state.result.user_answers[user_answer]].value;
                            } else if (for_L.includes(num_question)) {
                                results.points.L += this.answer_choices[state.result.user_answers[user_answer]].value;
                            } else {
                                console.error("Undefined question.");
                            }
                        }
                    }
                    let result_array = Object.keys(results.points).map(function (item) {return {"name": item, "value": results.points[item]}});
                    let max_points = Math.max.apply(Math, result_array.map(function(item){return item.value}));
                    results.user_types = result_array.filter(function (item) { return item.value === max_points;});

                    return results;
                };

                this.createTask = function(){
                    html_element.innerHTML = "";
                    let answer_table = createElement("table", null, "answer-table cm-table", {});
                    let table_heading = createElement("tr", null, null, {});
                    table_heading.innerHTML = "<th></th>";

                    let idx = 0;
                    for(let answer_choice in this.answer_choices){
                        let th = createElement("th", null, "heading-td", {});
                        th.innerHTML = this.answer_choices[answer_choice].text;
                        table_heading.append(th);
                        if (idx === 1) table_heading.append(createElement("th"));
                        idx++;
                    }
                    answer_table.append(table_heading);

                    for(let question in this.questions){
                        let table_tr = createElement("tr");
                        let table_td = createElement("td", null, "title-td");
                        table_td.innerHTML = this.questions[question].text;
                        table_tr.append(table_td);

                        if (!state.result.user_answers[question]) {
                            state.result.user_answers[question] = "";
                        }
                        let idx = 0;
                        for(let ans in this.answer_choices){
                            let radio_label = createElement("label", null, "radio-label", {});
                            let radio_input = createElement("input", null, "radio-input", {type: "radio", value: ans, name: question});

                            let that = this;
                            radio_input.addEventListener("change", function() {
                                state.result.user_answers[this.name] = this.value;
                                    if (Object.keys(state.result.user_answers).map(function (item) {
                                        return state.result.user_answers[item]
                                    }).every(function (element) {
                                        return element.length !== 0
                                    })) {
                                        state.completed = true;
                                        submit_button.enableButton();
                                    }else{
                                        submit_button.disableButton()
                                    }
                                    state.result.calculated = that.calculateResults();
                                    answer.setJSON({answer: state});
                            });

                            radio_label.append(radio_input);
                            if (state.result.user_answers[question]) {
                                if (state.result.user_answers[question] === ans) {
                                    radio_input.checked = true;
                                }
                            }
                            let choice_td = createElement("td", null, "radio-td", {});
                            choice_td.append(radio_label);
                            table_tr.append(choice_td);
                            if (idx === 1) table_tr.append(createElement("td", null, "empty-td"));
                            idx++;
                        }
                        answer_table.append(table_tr);
                    }

                    let instruction_label_block = createElement("h2");
                    instruction_label_block.innerHTML = user_labels.instruction_label;
                    this.block.append(instruction_label_block);

                    $(this.block).append("<p>" + user_labels.instruction_text + "</p>"); // change to pure js

                    this.block.append(answer_table);
                    html_element.append(this.block);
                };

                this.createResult = function(){
                    let result_block = createElement("div", null, "result-block", {});
                    let result_head = createElement("h2", null, "result-block", {});
                    result_head.innerHTML = user_labels.result_label + ":";
                    result_block.append(result_head);

                    if (state.result.calculated.user_types.length !== 1){
                        let result_alert = createElement("p", null, null, {});
                        result_alert.innerHTML = user_labels.some_result_alert_text;
                        result_block.append(result_alert);
                        $("span.submit-label", submit_button).html(user_labels.change_answers_btn_label);
                    }
                    else{
                        let res_block = createElement("p");
                        res_block.innerHTML = user_labels.result_text + ": ";
                        result_block.append(res_block);
                        state.result.calculated.user_types.forEach(function(item){
                            let res_block_1 = createElement("p");
                            res_block_1.innerHTML = types_description[item.name].title + ". " + types_description[item.name].description[0];

                            types_description[item.name].description.forEach(function (desc, index) {
                                if(index != 0){
                                    let res_block_desc = createElement("p");
                                    res_block_desc.innerHTML = desc;
                                    res_block_1.append(res_block_desc)
                                }
                            });

                            result_block.append(res_block_1);
                        });
                        $("span.submit-label", submit_button).html(user_labels.reset_btn_label);
                    }
                    reset_answer();
                    this.block.append(result_block);
                    html_element.append(this.block);
                }
            }

            let state = {
                completed: false,
                result: {
                    calculated: {},
                    user_answers: {},
                },
            };

            const language = "ru"; // "ru" or "en"

            const user_labels = translations[language];

            let answer = new Answer(document.querySelector("#constructive_motivation_input").querySelector("input[type='text']"));

            let constructive_motivation_block = document.getElementById("constructive_motivation_block");
            clearProblemSigns(constructive_motivation_block);

            let submit_button = $(constructive_motivation_block).closest(".problem").find("button.submit");
            submit_button.disableButton();

            let constructive_motivation = new ConstructiveMotivation(constructive_motivation_block);

            if (answer.get()) {
                state = answer.getJSON()["answer"];
                if (state.completed) {
                    submit_button.enableButton();
                    constructive_motivation.createResult();
                } else {
                    state.completed = true;
                    answer.setJSON({answer: state});
                    if (Object.keys(state.result.user_answers).map(function (item) {
                        return state.result.user_answers[item]
                    }).every(function (element) {
                        return element.length !== 0
                    })) {
                        state.completed = true;
                        submit_button.enableButton();
                    }else{
                        submit_button.disableButton()
                    }
                    constructive_motivation.createTask();
                }

            } else {
                constructive_motivation.createTask();
            }


        });
    </script>
    <div id="constructive_motivation_block"></div>
    <div id="constructive_motivation_input" style="display: none !important;"><customresponse cfn="check_answer"><textline/>
        </customresponse>
    </div>


</problem>

